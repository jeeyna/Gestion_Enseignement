<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Répartition des Enseignements</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.css}">
</head>
<body>
<div class="container mt-5">
    <h2 class="text-center">Répartition des Enseignements</h2>

    <div th:if="${not isChefDepartement}">
        <h3>Faire un choix d'enseignement</h3>
        <form th:action="@{/choix/valider}" method="post">
            <!-- Tableau des EC avec leurs types d'enseignement -->
            <table class="table">
                <thead>
                <tr>
                    <th>Libellé EC</th>
                    <th>CM</th>
                    <th>TD</th>
                    <th>TP</th>
                </tr>
                </thead>
                <tbody>

                <tr th:each="ec : ${listeEC}">
                    <td th:text="${ec.libelle}"></td>
                    <td>
                        <input type="radio" th:name="'typeSeance_' + ${ec.id}" th:value="'CM'" th:id="'cm_' + ${ec.id}">
                        <label th:for="'cm_' + ${ec.id}">CM</label>
                    </td>
                    <td>
                        <input type="radio" th:name="'typeSeance_' + ${ec.id}" th:value="'TD'" th:id="'td_' + ${ec.id}">
                        <label th:for="'td_' + ${ec.id}">TD</label>
                    </td>
                    <td>
                        <input type="radio" th:name="'typeSeance_' + ${ec.id}" th:value="'TP'" th:id="'tp_' + ${ec.id}">
                        <label th:for="'tp_' + ${ec.id}">TP</label>
                    </td>
                </tr>
                </tbody>
            </table>

            <input type="hidden" name="enseignantUsername" th:value="${#authentication.name}">
            <button type="submit" class="btn btn-primary">Valider mon choix</button>
        </form>
    </div>

    <div th:if="${isChefDepartement}">
        <h3>Validation des choix</h3>
        <table class="table">
            <thead>
            <tr>
                <th>Enseignant</th>
                <th>Enseignement</th>
                <th>Type</th>
                <th>Action</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="choix : ${choixEnAttente}">
                <td th:text="${choix.enseignant.nom}"></td>
                <td th:text="${choix.enseignement.nom}"></td>
                <td th:text="${choix.typeSeance}"></td>
                <td>
                    <form th:action="@{/choix/validerChef}" method="post">
                        <input type="hidden" name="choixId" th:value="${choix.id}">
                        <button type="submit" class="btn btn-success">Valider</button>
                    </form>
                    <form th:action="@{/choix/attribuerChef}" method="post">
                        <input type="hidden" name="choixId" th:value="${choix.id}">
                        <button type="submit" class="btn btn-warning">Attribuer à moi</button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

</body>
</html>
